
% Set up limits of the grid: x_min,y_min,x_max,y_max
grid_limits = [0, 0, 1000, 1000];
% Set up number of basis functions along each axis
nx = 4; ny = 4; order = 3;   

        [knots] = setup_spline_support(grid_limits,nx,ny,order);
        % Determine the length of support of a spline
        side1 = knots(1,2) - knots(1,1);                                    % along x axis
        side2 = knots(2,2) - knots(2,1);                                    % along y axis

% Arbitrary the scaling coefficients: vector of size (1xL), L = nx*ny
ll = nx*ny;                                                                 % total number of bfs
Theta_model = 10*[1:ll];                                                    % corresponding scaling coeffs
%% Plot the basis funcion grid in 3d
%fig('Grid','On'); 
%colormap(my_map);
for j=1:length(Theta_model)
            a = knots(1,j*2-1);
            b = knots(2,j*2-1);
            xx = a + side1/2 - 30;
            yy = b + side2/2 - 30;
   
    Theta_temp = zeros(length(Theta_model),1);                              % zero scaling coeffs for all bfs
    Theta_temp(j) = Theta_model(j);                                         % only choose one scaling coeff to non-zero
    surfb(Theta_temp,Z,knots,grid_limits,basis_type);
end
  